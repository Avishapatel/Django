{% extends 'index.html' %}
{% load static %}


<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>EShopper - Bootstrap Shop Template</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet"> 

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="static/css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Topbar Start -->
    <div class="container-fluid">
        <div class="row bg-secondary py-2 px-xl-5">
            <div class="col-lg-6 d-none d-lg-block">
                <div class="d-inline-flex align-items-center">
                    <a class="text-dark" href="">FAQs</a>
                    <span class="text-muted px-2">|</span>
                    <a class="text-dark" href="">Help</a>
                    <span class="text-muted px-2">|</span>
                    <a class="text-dark" href="">Support</a>
                </div>
            </div>
            <div class="col-lg-6 text-center text-lg-right">
                <div class="d-inline-flex align-items-center">
                    <a class="text-dark px-2" href="">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a class="text-dark px-2" href="">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a class="text-dark px-2" href="">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a class="text-dark px-2" href="">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a class="text-dark pl-2" href="">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="row align-items-center py-3 px-xl-5">
            <div class="col-lg-3 d-none d-lg-block">
                <a href="" class="text-decoration-none">
                    <h1 class="m-0 display-5 font-weight-semi-bold"><span class="text-primary font-weight-bold border px-3 mr-1">E</span>Shopper</h1>
                </a>
            </div>
            <div class="col-lg-6 col-6 text-left">
                <form action="">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search for products">
                        <div class="input-group-append">
                            <span class="input-group-text bg-transparent text-primary">
                                <i class="fa fa-search"></i>
                            </span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-lg-3 col-6 text-right">
                <a href="" class="btn border">
                    <i class="fas fa-heart text-primary"></i>
                    <span class="badge">0</span>
                </a>
                <a href="" class="btn border">
                    <i class="fas fa-shopping-cart text-primary"></i>
                    <span class="badge">0</span>
                </a>
            </div>
        </div>
    </div>
    <!-- Topbar End -->
{% block content %}

    <!-- Navbar Start -->
    <div class="container-fluid mb-4">
        <div class="row border-top px-xl-5">
            <div class="col-lg-3 d-none d-lg-block">
                <a class="btn shadow-none d-flex align-items-center justify-content-between bg-primary text-white w-100" data-toggle="collapse" href="#navbar-vertical" style="height: 65px; margin-top: -1px; padding: 0 30px;">
                    <h6 class="m-0">Categories</h6>
                    <i class="fa fa-angle-down text-dark"></i>
                </a>
                <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 border bg-white shadow" id="navbar-vertical" style="width: calc(100% - 30px); z-index: 9999; height: 530px; overflow-y: auto;">

                <!-- <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 border border-top-0 border-bottom-0 bg-light" id="navbar-vertical" style="width: calc(100% - 30px); z-index: 1;"> -->
                    <div class="navbar-nav w-100 overflow-hidden" style="height: 530px">
                        {% for i in c_id %}
                        <div class="nav-item dropdown">
                            <a href="#" class="nav-link" data-toggle="dropdown">{{ i.cat_name }} <i class="fa fa-angle-down float-right mt-1"></i></a>
                            <div class="dropdown-menu position-absolute bg-secondary border-0 rounded-0 w-100 m-0">
                                {% for sub in i.sub_category_set.all %}
                                    <a href="{% url 'shop' %}?s_id={{ sub.id }}" class="dropdown-item">{{ sub.sbcat_name }}</a>
                                {% empty %}
                                    <span class="dropdown-item disabled">No subcategories</span>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                       
                    </div>
                </nav>
            </div>
            <div class="col-lg-9">
                <nav class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-0">
                    <a href="" class="text-decoration-none d-block d-lg-none">
                        <h1 class="m-0 display-5 font-weight-semi-bold"><span class="text-primary font-weight-bold border px-3 mr-1">E</span>Shopper</h1>
                    </a>
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                        <div class="navbar-nav mr-auto py-0">
                            <a href="{% url 'index' %}" class="nav-item nav-link">Home</a>
                            <a href="{% url 'shop' %}" class="nav-item nav-link">Shop</a>
                            <a href="{% url 'detail' %}" class="nav-item nav-link active">Shop Detail</a>
                            <div class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Pages</a>
                                <div class="dropdown-menu rounded-0 m-0">
                                    <a href="{% url 'cart' %}" class="dropdown-item">Shopping Cart</a>
                                    <a href="{% url 'checkout' %}" class="dropdown-item">Checkout</a>
                                    <a href="{% url 'wishlist' %}"class="dropdown-item">Wishlist</a>
                                    <a href="{% url 'my_orders' %}"class="dropdown-item">My Orders</a>
                                </div>
                            </div>
                            <a href="{% url 'contact' %}" class="nav-item nav-link">Contact</a>
                        </div>
                       <div class="navbar-nav ml-auto py-0">
                            {% if request.session.user_name %}
                                <a href="{% url 'profile' %}" class="nav-item nav-link">Hi, {{ request.session.user_name }}</a>
                                <a href="{% url 'logout' %}" class="nav-item nav-link">Logout</a>  <!-- <-- use logout URL -->
                            {% else %}
                                <a href="{% url 'login' %}" class="nav-item nav-link">Login</a>
                                <a href="{% url 'register' %}" class="nav-item nav-link">Register</a>
                            {% endif %}
                        </div>
                    </div>
                </nav>
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
        {% if 'logout' in message.tags %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <script>
                setTimeout(function() {
                    $('.alert').fadeOut('slow', function() { $(this).remove(); });
                }, 3000);  <!-- auto-dismiss after 3 seconds -->
            </script>
        {% endif %}
    {% endfor %}
</div>
{% endif %}

            </div>
        </div>
    </div>
    <!-- Navbar End -->


    <!-- Page Header Start -->
    <div class="container-fluid bg-secondary">
        <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 200px">
            <h2 class="font-weight-semi-bold text-uppercase mb-3">Shop Detail</h2>
            <div class="d-inline-flex">
                <p class="m-0"><a href="{% url 'index' %}">Home</a></p>
                <p class="m-0 px-2">-</p>
                <p class="m-0">Shop Detail</p>
            </div>
        </div>
    </div>
    <!-- Page Header End -->


    <!-- Shop Detail Start -->
    <div class="container-fluid py-5">
        <div class="row px-xl-5">
            <div class="col-lg-5 pb-5">
                <div id="product-carousel" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner border">
                        <div class="carousel-item active">
                            <img class="w-100 h-100" src="{{selected_product.product_img.url}}" alt="Image">
                        </div>
                        
                    </div>
                    <a class="carousel-control-prev" href="#product-carousel" data-slide="prev">
                        <i class="fa fa-2x fa-angle-left text-dark"></i>
                    </a>
                    <a class="carousel-control-next" href="#product-carousel" data-slide="next">
                        <i class="fa fa-2x fa-angle-right text-dark"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-7 pb-5">
                <h3 class="font-weight-semi-bold">{{selected_product.product_name}}</h3>
                <div class="d-flex mb-3">

                     <style>
                                            #rating-box {
                                                font-size: 18px;
                                                cursor: pointer;
                                                color: #ccc;
                                            }

                                            .fa-star,
                                            .fa-star-half-o {
                                                color: #C17A75; /* yellow */
                                            }


                                        </style>

                    <div class="text-primary mr-2">
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star"></small>
                        <small class="fas fa-star-half-alt"></small>
                        <small class="far fa-star"></small>
                    </div>
                    <small class="pt-1">(50 Reviews)</small>
                </div>
                <h3 class="font-weight-semi-bold mb-4"><i class="fa-solid fa-indian-rupee-sign"></i>{{selected_product.product_price}}</h3>
                <p class="mb-4">This product offers a clean design and reliable quality.
It is suitable for daily use and ideal for different occasions.
Designed to provide comfort, durability, and long-lasting performance.</p>
                <div class="d-flex mb-3">
                    <p class="text-dark font-weight-medium mb-0 mr-3">Sizes:</p>
                    <form>
                        {% for size in size_id %}
                        <div class="custom-control custom-radio custom-control-inline">
                            <input type="radio" class="custom-control-input" id="size{{size.id}}" name="size" value="{{size.id}}">
                            <label class="custom-control-label" for="size{{size.id}}">{{size.size_name}}</label>
                        </div>
                        {% endfor %}
                        
                    </form>
                </div>
                <div class="d-flex mb-4">
                    <p class="text-dark font-weight-medium mb-0 mr-3">Colors:</p>
                    <form>
                        {% for color in color_id %}
                        <div class="custom-control custom-radio custom-control-inline">
                            <input type="radio" class="custom-control-input" id="color{{color.id}}" name="color" value="{{color.id}}">
                            <label class="custom-control-label" for="color{{color.id}}">{{color.color_name}}</label>
                        </div>
                        {% endfor %}
                        
                    </form>
                </div>
                <div class="d-flex align-items-center mb-4 pt-2">
                    
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/fontawesome.min.css" integrity="sha512-M5Kq4YVQrjg5c2wsZSn27Dkfm/2ALfxmun0vUE3mPiJyK53hQBHYCVAtvMYEC7ZXmYLg8DVG4tF8gD27WmDbsg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
                   
                    {% if selected_product.id in cart_product_ids %}    
                    
                    <form method="post" action="{% url 'cart' %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary px-3"><i class="fa-duotone fa-solid fa-bag-shopping  mr-1"></i>Go to Bag</button>
                    </form>

                    {% else %}

                    <form method="post" action="{% url 'add_to_cart' %}?product_id={{selected_product.id}}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary px-3"><i class="fa fa-shopping-cart mr-1"></i> Add To Cart</button>
                    </form>

                    {% endif %}
                    

                    
                                  

                </div>
                <div class="d-flex pt-2">
                    <p class="text-dark font-weight-medium mb-0 mr-2">Share on:</p>
                    <div class="d-inline-flex">
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a class="text-dark px-2" href="">
                            <i class="fab fa-pinterest"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row px-xl-5">
            <div class="col">
                <div class="nav nav-tabs justify-content-center border-secondary mb-4">
                    <a class="nav-item nav-link active" data-toggle="tab" href="#tab-pane-1">Description</a>
                    <a class="nav-item nav-link" data-toggle="tab" href="#tab-pane-2">Information</a>
                    <a class="nav-item nav-link" data-toggle="tab" href="#tab-pane-3">Reviews ({{review_id.count}})</a>
                </div>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="tab-pane-1">
                        <h4 class="mb-3">Product Description</h4>
                       <p>
                        High-quality products designed to meet your everyday needs. Built with premium materials,
                        modern design, and reliable performance to ensure long-lasting satisfaction. Each item is
                        crafted with attention to detail to enhance both functionality and style.
                        </p>

                        <p>
                        Every product undergoes strict quality checks to guarantee durability, consistency, and
                        a smooth, reliable user experience. We prioritize performance and usability to make sure
                        you get the best value.
                        </p>

                        <p>
                        Carefully selected to offer the best combination of comfort, practicality, and style.
                        Perfect for regular use, suitable for all occasions, and designed to complement a
                        modern lifestyle seamlessly.
                        </p>

                        <p>
                        An ideal choice for those who value quality, reliability, and elegant design,
                        while enjoying excellent performance at an affordable price. Our products are made
                        to enhance your daily life and provide lasting satisfaction.
                        </p>

                            </div>
                    <div class="tab-pane fade" id="tab-pane-2">
                        <h4 class="mb-3">Additional Information</h4>
                       <p>
                                Discover high-quality products designed to meet your everyday needs. Crafted with
                                premium materials and modern design, each item delivers reliable performance and
                                long-lasting satisfaction.
                                </p>

                                <p>
                                Each product undergoes strict quality checks to ensure durability, functionality,
                                and a smooth, reliable user experience. Designed to complement modern lifestyles
                                with ease and convenience.
                                </p>

                                <p>
                                Perfect for enhancing your lifestyle with comfort, style, and functionality. An ideal
                                choice for those who value quality, reliability, and elegant design at an affordable price.
                                </p>


                                <div class="row">
                                    <div class="col-md-6">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item px-0">
                                                Durable construction with high-quality materials.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Elegant and modern design suitable for all occasions.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Comfortable and user-friendly for daily use.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Strict quality checks to ensure long-lasting performance.
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item px-0">
                                                Versatile and practical for home, office, or travel.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Offers excellent value for money.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Lightweight and easy to handle.
                                            </li>
                                            <li class="list-group-item px-0">
                                                Designed to complement a modern lifestyle seamlessly.
                                            </li>
                                        </ul>
                                    </div>


                        </div>
                    </div>
                    
                    <div class="tab-pane fade" id="tab-pane-3">
                        <div class="row">
                            
                            <div class="col-md-6">
                                <h4 class="mb-4">{{review_id.count}} review for "{{selected_product.product_name}}"</h4>
                                {% for review in review_id %}
                                <div class="media mb-4">

                                    {% if review.register_user.user_img %}
                                        <img src="{{review.register_user.user_img.url}}" alt="Image" class="img-fluid mr-3 mt-1" style="width: 45px;">
                                    {% else %}
                                        <img src="{% static 'img/user_img.jpg' %}" alt="Default User Image" class="img-fluid mr-3 mt-1" style="width: 45px;">
                                    {% endif %}

                                    
                                    <div class="media-body">
                                        <h6>{{review.register_user.full_name}}<small> - <i>{{review.date}}</i></small></h6>
                                        <div class="text-primary mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star-half-alt"></i>
                                            <i class="far fa-star"></i>
                                        </div>
                                        <p>{{review.review}}</p> </div>
                                </div>
                                {% endfor %}
                            </div>
                            



                            <div class="col-md-6">
                                <h4 class="mb-4">Leave a review</h4>
                                 {% if messages %}
                    {% for message in messages %}
                        <div class="alert 
                        {% if message.tags == 'success' %}alert-success
                        {% elif message.tags == 'error' %}alert-danger
                        {% endif %}
                        auto-hide-message">
                        {{ message }}
                        </div>
                    {% endfor %}
                    {% endif %}


                    <script>
                        setTimeout(function () {
                            const alerts = document.querySelectorAll('.auto-hide-message');
                            alerts.forEach(function(alert) {
                            alert.style.opacity = '0';
                            setTimeout(() => alert.remove(), 500);
                            });
                        }, 3000);
                        </script>
                                <small>Your email address will not be published. Required fields are marked *</small>
                                <form id="reviewForm" action="{% url 'save_review' %}" method="post">
                                {% csrf_token %}
                                 <input type="hidden" name="product_id" value="{{ selected_product.id }}">
                                   
                                    <!-- Old rating (to auto-fill) -->
                                    <input type="hidden" id="old-rating" value="{{ user_rating }}">
                                    <div class="d-flex my-3">
                                    <p class="mb-0 mr-2">Your Rating * </p>
                                        

                                        <style>
                                            #rating-box {
                                                font-size: 18px;
                                                cursor: pointer;
                                                color: #ccc;
                                            }

                                            .fa-star,
                                            .fa-star-half-o {
                                                color: #C17A75; /* yellow */
                                            }


                                        </style>

                                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

                                    <div id="rating-box">
                                        <span class="fa fa-star-o star" data-index="1"></span>
                                        <span class="fa fa-star-o star" data-index="2"></span>
                                        <span class="fa fa-star-o star" data-index="3"></span>
                                        <span class="fa fa-star-o star" data-index="4"></span>
                                        <span class="fa fa-star-o star" data-index="5"></span>

                                    </div>
                                    <input type="hidden" id="rating-input" name="rating">

                                    <p><span id="rating-display" style="margin-left: 20px;">0</span>/5</p>
                                    

                                    <script>
                                            const stars = document.querySelectorAll(".star");
                                        const ratingSpan = document.getElementById("rating-display");
                                        const ratingInput = document.getElementById("rating-input");
                                        const oldRating = parseFloat(document.getElementById("old-rating").value);

                                        let selectedRating = 0;
                                        
                                        // Auto-fill user's old rating
                                            if (oldRating > 0) {
                                                selectedRating = oldRating;
                                                ratingSpan.innerText = oldRating;
                                                ratingInput.value = oldRating;
                                                fillStars(oldRating);
                                            }

                                        stars.forEach(star => {

                                            star.addEventListener("mousemove", function (e) {
                                                let idx = parseInt(this.dataset.index);
                                                let rect = this.getBoundingClientRect();
                                                let x = e.clientX - rect.left;

                                                let value = x < rect.width / 2 ? idx - 0.5 : idx;

                                                fillStars(value);

                                                ratingSpan.innerText = value;
                                            });

                                            star.addEventListener("mouseout", function () {
                                                fillStars(selectedRating);

                                                ratingSpan.innerText = selectedRating || 0;
                                            });

                                            star.addEventListener("click", function (e) {
                                                let idx = parseInt(this.dataset.index);
                                                let rect = this.getBoundingClientRect();
                                                let x = e.clientX - rect.left;

                                                selectedRating = x < rect.width / 2 ? idx - 0.5 : idx;

                                                ratingSpan.innerText = selectedRating;
                                                ratingInput.value = selectedRating;  // store rating for form
                                            });
                                        });

                                        function fillStars(value) {
                                            stars.forEach(star => {
                                                let idx = parseInt(star.dataset.index);

                                                star.classList.remove("fa-star", "fa-star-half-o", "fa-star-o");

                                                if (value >= idx) {
                                                    star.classList.add("fa-star");
                                                } else if (value + 0.5 === idx) {
                                                    star.classList.add("fa-star-half-o");
                                                } else {
                                                    star.classList.add("fa-star-o");
                                                }
                                            });
                                        }

                                    </script>




                                </div>
                                    <div class="form-group">
                                        <label for="message">Your Review</label>
                                        <textarea id="message" cols="30" rows="5" class="form-control" name="review">{{ user_review|default_if_none:"" }}</textarea>
                                    </div>
                                    <div class="form-group">
                                        <label for="name">Your Name</label>
                                        <input type="text" class="form-control" id="name" name="name" value="{{user_name}}" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label for="email">Your Email</label>
                                        <input type="email" class="form-control" id="email" name="email" value="{{user_email}}" readonly>
                                    </div>
                                    <div class="form-group mb-0">
                                        <button type="submit" class="btn btn-primary px-3">Leave Your Review</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Shop Detail End -->


    <!-- Products Start -->
    <div class="container-fluid py-5">
        <div class="text-center mb-4">
            <h2 class="section-title px-5 mb-5"><span class="px-2">You May Also Like</span></h2>
        </div>
        <div class="row px-xl-5">
            <div class="col">
                <div class="owl-carousel related-carousel" style="display: flex; gap: 20px;">

                    <style>
        .product-carousel {
          display: flex;
          gap: 20px;
          overflow: hidden;
          white-space: nowrap;
        }

        .product-track {
          display: flex;
          gap: 20px;
          animation: scroll 40s linear infinite;
        }

       

        @keyframes scroll {
          0% {
            transform: translateX(0);
          }
          100% {
            transform: translateX(-50%);
          }
        }
      </style>

                    <div class="product-carousel">
        <div class="product-track">
                    {% for i in like_product %}
                    <div class="card product-item border-0" style="width: 270px;">
                        <div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0" 
                        style="height:220px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
                            <img class="img-fluid w-100" src="{{i.product_img.url}}" alt="" style="max-height:100%; width:100%; object-fit:contain;">
                        </div>
                        <div class="card-body border-left border-right text-center p-0 pt-4 pb-3">
                            <h6 class="text-truncate mb-3 px-2">{{i.product_name}}</h6>
                            <div class="d-flex justify-content-center">
                                <h6><i class="fa-solid fa-indian-rupee-sign"></i>{{i.product_price}}</h6><h6 class="text-muted ml-2"></h6>
                            </div>
                        </div>
                        <div class="card-footer d-flex bg-light border p-1" style="flex-wrap: nowrap;">

                                <a href="{% url 'view_details' %}?product_id={{i.id}}"
                                class="btn btn-sm btn-outline-dark text-center custom-btn mr-1 w-50">
                                    <i class="fas fa-eye text-primary mr-1"></i>
                                    <span class="btn-text">View Detail</span>
                                </a>

                                {% if i.id in cart_product_ids %}
                                    <a href="{% url 'cart' %}"
                                    class="btn btn-sm btn-outline-dark text-center custom-btn w-50" style="background-color:#D09C97; color: white;">
                                        <i class="fa-solid fa-bag-shopping mr-1"></i>
                                        <span class="btn-text">Go to Bag</span>
                                    </a>
                                {% else %}
                                    <a href="{% url 'add_to_cart' %}?product_id={{i.id}}"
                                    class="btn btn-sm btn-outline-dark text-center custom-btn w-50">
                                        <i class="fas fa-shopping-cart text-primary mr-1"></i>
                                        <span class="btn-text">Add To Cart</span>
                                    </a>
                                {% endif %}

                    </div>
                    </div>
                    {% endfor %}
                   
                </div>
                </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Products End -->
{% endblock %}

    <!-- Footer Start -->
    <div class="container-fluid bg-secondary text-dark mt-5 pt-5">
        <div class="row px-xl-5 pt-5">
            <div class="col-lg-4 col-md-12 mb-5 pr-3 pr-xl-5">
                <a href="" class="text-decoration-none">
                    <h1 class="mb-4 display-5 font-weight-semi-bold"><span class="text-primary font-weight-bold border border-white px-3 mr-1">E</span>Shopper</h1>
                </a>
                <p>Dolore erat dolor sit lorem vero amet. Sed sit lorem magna, ipsum no sit erat lorem et magna ipsum dolore amet erat.</p>
                <p class="mb-2"><i class="fa fa-map-marker-alt text-primary mr-3"></i>123 Street, New York, USA</p>
                <p class="mb-2"><i class="fa fa-envelope text-primary mr-3"></i>info@example.com</p>
                <p class="mb-0"><i class="fa fa-phone-alt text-primary mr-3"></i>+012 345 67890</p>
            </div>
            <div class="col-lg-8 col-md-12">
                <div class="row">
                    <div class="col-md-4 mb-5">
                        <h5 class="font-weight-bold text-dark mb-4">Quick Links</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-dark mb-2" href="index.html"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-dark mb-2" href="shop.html"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <a class="text-dark mb-2" href="detail.html"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a>
                            <a class="text-dark mb-2" href="cart.html"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-dark mb-2" href="checkout.html"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-dark" href="contact.html"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="font-weight-bold text-dark mb-4">Quick Links</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-dark mb-2" href="index.html"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-dark mb-2" href="shop.html"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <a class="text-dark mb-2" href="detail.html"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a>
                            <a class="text-dark mb-2" href="cart.html"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-dark mb-2" href="checkout.html"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-dark" href="contact.html"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="font-weight-bold text-dark mb-4">Newsletter</h5>
                        {% if subscriber %}
                        <form action="{% url 'unsubscribe' %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name="source" value="footer_subscribe">
                            <div class="form-group">
                                <input type="text" class="form-control border-0 py-4" placeholder="Your Name" value="{{user_name.full_name}}" name="name" readonly />
                            </div>
                            <div class="form-group">
                                <input type="email" class="form-control border-0 py-4" placeholder="Your Email" value="{{user_name.email_id}}" name="email"
                                   readonly />
                            </div>
                            <div>
                                <button class="btn btn-primary btn-block border-0 py-3" type="submit">Unsubscribe</button>
                            </div>
                        </form>
                        {% else %}
                        <form action="{% url 'subscribe' %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name="source" value="footer_subscribe">

                            <div class="form-group">
                                <input type="text" class="form-control border-0 py-4" placeholder="Your Name" value="{{user_name.full_name}}" name="name" required />
                            </div>
                            <div class="form-group">
                                <input type="email" class="form-control border-0 py-4" placeholder="Your Email" value="{{user_name.email_id}}" name="email"
                                   readonly />
                            </div>
                            <div>
                                <button class="btn btn-primary btn-block border-0 py-3" type="submit">Subscribe Now</button>
                            </div>
                        </form>
                      {% endif %}
                       
                   
                    </div>
                </div>
                
                    {% if messages %}
                    {% for message in messages %}
                        {% if 'footer_subscribe' in message.tags %}
                        <div class="alert 
                            {% if 'success' in message.tags %}alert-success
                            {% elif 'error' in message.tags %}alert-danger
                            {% endif %}
                            auto-hide-message">
                            {{ message }}
                        </div>
                        {% endif %}
                    {% endfor %}
                    {% endif %}

                    <script>
                        setTimeout(function () {
                            const alerts = document.querySelectorAll('.auto-hide-message');
                            alerts.forEach(function(alert) {
                            alert.style.opacity = '0';
                            setTimeout(() => alert.remove(), 500);
                            });
                        }, 3000);
                        </script>

            </div>
        </div>
        <div class="row border-top border-light mx-xl-5 py-4">
            <div class="col-md-6 px-xl-0">
                <p class="mb-md-0 text-center text-md-left text-dark">
                    &copy; <a class="text-dark font-weight-semi-bold" href="#">Your Site Name</a>. All Rights Reserved. Designed
                    by
                    <a class="text-dark font-weight-semi-bold" href="https://htmlcodex.com">HTML Codex</a><br>
                    Distributed By <a href="https://themewagon.com" target="_blank">ThemeWagon</a>
                </p>
            </div>
            <div class="col-md-6 px-xl-0 text-center text-md-right">
                <img class="img-fluid" src="static/img/payments.png" alt="">
            </div>
        </div>
    </div>
    <!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>